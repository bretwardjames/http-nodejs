<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <title>Calendar Event Button</title>
</head>

<body>
    <button class="btn btn-success dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false"
        id="addToCalendar">Add to Calendar</button>

    <script>
        // Function to get URL parameters
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                title: params.get('title') || 'Event Title',
                description: params.get('description') || 'Event Description',
                location: params.get('location') || 'Event Location',
                start: params.get('start') || '2024-01-01T10:00:00',
                end: params.get('end') || '2024-01-01T11:00:00'
            };
        }

        // Function to generate Google Calendar URL
        function generateGoogleCalendarUrl(params) {
            return `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(params.title)}&details=${encodeURIComponent(params.description)}&location=${encodeURIComponent(params.location)}&dates=${encodeURIComponent(params.start)}/${encodeURIComponent(params.end)}`;
        }

        // Function to generate iCal download link
        function generateICalUrl(params) {
            const icsData = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${params.title}
DESCRIPTION:${params.description}
LOCATION:${params.location}
DTSTART:${params.start.replace(/[-:]/g, '')}
DTEND:${params.end.replace(/[-:]/g, '')}
END:VEVENT
END:VCALENDAR`;
            const blob = new Blob([icsData], { type: 'text/calendar' });
            return URL.createObjectURL(blob);
        }

        // Function to generate Outlook Calendar URL
        function generateOutlookCalendarUrl(params) {
            return `https://outlook.live.com/owa/?path=/calendar/action/compose&subject=${encodeURIComponent(params.title)}&body=${encodeURIComponent(params.description)}&location=${encodeURIComponent(params.location)}&startdt=${encodeURIComponent(params.start)}&enddt=${encodeURIComponent(params.end)}`;
        }

        document.getElementById('addToCalendar').addEventListener('click', () => {
            const params = getUrlParams();

            const googleUrl = generateGoogleCalendarUrl(params);
            const icalUrl = generateICalUrl(params);
            const outlookUrl = generateOutlookCalendarUrl(params);

            const calendarLinks = `
                <a class="dropdown-item" href="${googleUrl}" target="_blank">Google Calendar</a><br>
                <a class="dropdown-item" href="${icalUrl}" download="event.ics">iCal</a><br>
                <a class="dropdown-item" href="${outlookUrl}" target="_blank">Outlook Calendar</a>
            `;

            // Open the calendar options (you can customize this part)
            document.body.innerHTML += `<ul class="dropdown-menu" aria-labelledby="addToCalendar">${calendarLinks}</ul>`;
        });
    </script>
</body>

</html>